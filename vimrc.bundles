" ################### åŒ…ä¾èµ– #####################
" package dependence:  ctags, ag(he_silver_searcher)
" python dependence:   pep8, pyflake

" éå…¼å®¹viæ¨¡å¼ã€‚å»æ‰è®¨åŒçš„æœ‰å…³viä¸€è‡´æ€§æ¨¡å¼ï¼Œé¿å…ä»¥å‰ç‰ˆæœ¬çš„ä¸€äº›bugå’Œå±€é™
set nocompatible
" configure Vundle
filetype off " required! turn off
set rtp+=~/.vim/bundle/vundle/
call vundle#rc()


Bundle 'gmarik/vundle'

" å¤šè¯­è¨€è¯­æ³•æ£€æŸ¥
Bundle 'scrooloose/syntastic'

set statusline+=%#warningmsg#
set statusline+=%{SyntasticStatuslineFlag()}
set statusline+=%*

let g:syntastic_always_populate_loc_list = 1
let g:syntastic_loc_list_height = 5
let g:syntastic_auto_loc_list = 0
let g:syntastic_check_on_open = 1
let g:syntastic_check_on_wq = 1
let g:syntastic_javascript_checkers = ['eslint']

let g:syntastic_error_symbol = 'âŒ'
let g:syntastic_style_error_symbol = 'â‰ï¸'
let g:syntastic_warning_symbol = 'âš ï¸'
let g:syntastic_style_warning_symbol = 'ğŸ’©'

highlight link SyntasticErrorSign SignColumn
highlight link SyntasticWarningSign SignColumn
highlight link SyntasticStyleErrorSign SignColumn
highlight link SyntasticStyleWarningSign SignColumn

let g:syntastic_mode_map = {
    \ "passive_filetypes": ["javascript"] }

function! ToggleErrors()
    let old_last_winnr = winnr('$')
    lclose
    if old_last_winnr == winnr('$')
        " Nothing was closed, open syntastic error location panel
        Errors
    endif
endfunction
nnoremap <Leader>s :call ToggleErrors()<cr>
nnoremap <Leader>c :call SyntasticCheck()<cr>
" nnoremap <Leader>sn :lnext<cr>
" nnoremap <Leader>sp :lprevious<cr>

Bundle 'Valloric/YouCompleteMe'
"youcompleteme  é»˜è®¤tab  s-tab å’Œè‡ªåŠ¨è¡¥å…¨å†²çª
"let g:ycm_key_list_select_completion=['<c-n>']
let g:ycm_key_list_select_completion = ['<Down>']
"let g:ycm_key_list_previous_completion=['<c-p>']
let g:ycm_key_list_previous_completion = ['<Up>']
let g:ycm_complete_in_comments = 1  "åœ¨æ³¨é‡Šè¾“å…¥ä¸­ä¹Ÿèƒ½è¡¥å…¨
let g:ycm_complete_in_strings = 1   "åœ¨å­—ç¬¦ä¸²è¾“å…¥ä¸­ä¹Ÿèƒ½è¡¥å…¨
let g:ycm_use_ultisnips_completer = 1 "æç¤ºUltiSnips
let g:ycm_collect_identifiers_from_comments_and_strings = 1   "æ³¨é‡Šå’Œå­—ç¬¦ä¸²ä¸­çš„æ–‡å­—ä¹Ÿä¼šè¢«æ”¶å…¥è¡¥å…¨
let g:ycm_collect_identifiers_from_tags_files = 1

" è·³è½¬åˆ°å®šä¹‰å¤„, åˆ†å±æ‰“å¼€
let g:ycm_goto_buffer_command = 'horizontal-split'
nnoremap <leader>jd :YcmCompleter GoToDefinition<CR>
" nnoremap <leader>jd :YcmCompleter GoToDefinitionElseDeclaration<CR>
nnoremap <leader>gd :YcmCompleter GoToDeclaration<CR>

" å¼•å…¥ï¼Œå¯ä»¥è¡¥å…¨ç³»ç»Ÿï¼Œä»¥åŠpythonçš„ç¬¬ä¸‰æ–¹åŒ… é’ˆå¯¹æ–°è€ç‰ˆæœ¬YCMåšäº†å…¼å®¹
" old version
if !empty(glob("~/.vim/bundle/YouCompleteMe/cpp/ycm/.ycm_extra_conf.py"))
    let g:ycm_global_ycm_extra_conf = "~/.vim/bundle/YouCompleteMe/cpp/ycm/.ycm_extra_conf.py"
endif
" new version
if !empty(glob("~/.vim/bundle/YouCompleteMe/third_party/ycmd/cpp/ycm/.ycm_extra_conf.py"))
    let g:ycm_global_ycm_extra_conf = "~/.vim/bundle/YouCompleteMe/third_party/ycmd/cpp/ycm/.ycm_extra_conf.py"
endif

" ç›´æ¥è§¦å‘è‡ªåŠ¨è¡¥å…¨ insertæ¨¡å¼ä¸‹
" let g:ycm_key_invoke_completion = '<C-Space>'
" é»‘åå•,ä¸å¯ç”¨
let g:ycm_filetype_blacklist = {
      \ 'tagbar' : 1,
      \ 'gitcommit' : 1,
      \}

" ä»£ç ç‰‡æ®µå¿«é€Ÿæ’å…¥ (snippetsä¸­,æ˜¯ä»£ç ç‰‡æ®µèµ„æº,éœ€è¦å­¦ä¹ )
" Bundle 'SirVer/ultisnips'
" Snippets are separated from the engine. Add this if you want them:
" Bundle 'honza/vim-snippets'

" let g:UltiSnipsExpandTrigger       = "<tab>"
" let g:UltiSnipsJumpForwardTrigger  = "<tab>"
" let g:UltiSnipsJumpBackwardTrigger = "<s-tab>"
" let g:UltiSnipsSnippetDirectories  = ['UltiSnips']
" let g:UltiSnipsSnippetsDir = '~/.vim/UltiSnips'
" å®šä¹‰å­˜æ”¾ä»£ç ç‰‡æ®µçš„æ–‡ä»¶å¤¹ .vim/UltiSnipsä¸‹ï¼Œä½¿ç”¨è‡ªå®šä¹‰å’Œé»˜è®¤çš„ï¼Œå°†ä¼šçš„åˆ°å…¨å±€ï¼Œæœ‰å†²çªçš„ä¼šæç¤º
" è¿›å…¥å¯¹åº”filetypeçš„snippetsè¿›è¡Œç¼–è¾‘
" map <leader>us :UltiSnipsEdit<CR>

" ctrl+j/k è¿›è¡Œé€‰æ‹©
func! g:JInYCM()
    if pumvisible()
        return "\<C-n>"
    else
        return "\<c-j>"
    endif
endfunction

func! g:KInYCM()
    if pumvisible()
        return "\<C-p>"
    else
        return "\<c-k>"
    endif
endfunction
inoremap <c-j> <c-r>=g:JInYCM()<cr>
au BufEnter,BufRead * exec "inoremap <silent> " . g:UltiSnipsJumpBackwordTrigger . " <C-R>=g:KInYCM()<cr>"
let g:UltiSnipsJumpBackwordTrigger = "<c-k>"

" è‡ªåŠ¨è¡¥å…¨å•å¼•å·ï¼ŒåŒå¼•å·ç­‰
Bundle 'Raimondi/delimitMate'

"" for python docstring ",ä¼˜åŒ–è¾“å…¥
au FileType python let b:delimitMate_nesting_quotes = ['"']
" å…³é—­æŸäº›ç±»å‹æ–‡ä»¶çš„è‡ªåŠ¨è¡¥å…¨
"au FileType mail let b:delimitMate_autoclose = 0

" è‡ªåŠ¨è¡¥å…¨html/xmlæ ‡ç­¾
Bundle 'docunext/closetag.vim'
let g:closetag_html_style=1

" å¿«é€Ÿæ³¨é‡Š
Bundle 'scrooloose/nerdcommenter'
let g:NERDSpaceDelims=1


" å¿«é€ŸåŠ å…¥ä¿®æ”¹ç¯ç»•å­—ç¬¦
" Bundle 'tpope/vim-surround'
" for repeat -> enhance surround.vim, . to repeat command
" Bundle 'tpope/vim-repeat'

" å¿«é€Ÿå»è¡Œå°¾ç©ºæ ¼ [, + <Space>]
Bundle 'bronson/vim-trailing-whitespace'
map <leader><space> :FixWhitespace<cr>

" å¿«é€Ÿèµ‹å€¼è¯­å¥å¯¹é½
" Bundle 'junegunn/vim-easy-align'
" vmap <Leader>a <Plug>(EasyAlign)
" nmap <Leader>a <Plug>(EasyAlign)
" if !exists('g:easy_align_delimiters')
  " let g:easy_align_delimiters = {}
" endif
" let g:easy_align_delimiters['#'] = { 'pattern': '#', 'ignore_groups': ['String'] }

"æ›´é«˜æ•ˆçš„ç§»åŠ¨ [,, + w/fx]
" Bundle 'Lokaltog/vim-easymotion'
" let g:EasyMotion_smartcase = 1
"let g:EasyMotion_startofline = 0 " keep cursor colum when JK motion
" map <Leader><leader>h <Plug>(easymotion-linebackward)
" map <Leader><Leader>j <Plug>(easymotion-j)
" map <Leader><Leader>k <Plug>(easymotion-k)
" map <Leader><leader>l <Plug>(easymotion-lineforward)
" é‡å¤ä¸Šä¸€æ¬¡æ“ä½œ, ç±»ä¼¼repeatæ’ä»¶, å¾ˆå¼ºå¤§
" map <Leader><leader>. <Plug>(easymotion-repeat)

" Bundle 'vim-scripts/matchit.zip'

" æ˜¾ç¤ºmarks - æ–¹ä¾¿è‡ªå·±è¿›è¡Œæ ‡è®°å’Œè·³è½¬
" m[a-zA-Z] add mark
" '[a-zA-Z] go to mark
" m<Space>  del all marks
" Bundle "kshenoy/vim-signature"

" æ”¯æŒè‡ªå®šä¹‰æ–‡æœ¬å¯¹è±¡
" Bundle 'kana/vim-textobj-user.git'
" å¢åŠ è¡Œæ–‡æœ¬å¯¹è±¡: l   dal yal cil
" Bundle 'kana/vim-textobj-line'
" å¢åŠ æ–‡ä»¶æ–‡æœ¬å¯¹è±¡: e   dae yae cie
" Bundle 'kana/vim-textobj-entire.git'
" å¢åŠ ç¼©è¿›æ–‡æœ¬å¯¹è±¡: i   dai yai cii - ç›¸åŒç¼©è¿›å±äºåŒä¸€å—
" Bundle 'kana/vim-textobj-indent.git'

" ################### å¿«é€Ÿé€‰ä¸­ ###################
" é€‰ä¸­åŒºå—
Bundle 'terryma/vim-expand-region'
" map + <Plug>(expand_region_expand)
" map _ <Plug>(expand_region_shrink)
vmap v <Plug>(expand_region_expand)
vmap V <Plug>(expand_region_shrink)

" å¤šå…‰æ ‡é€‰ä¸­ç¼–è¾‘
Bundle 'terryma/vim-multiple-cursors'
let g:multi_cursor_use_default_mapping=0
" Default mapping
let g:multi_cursor_next_key='<C-m>'
let g:multi_cursor_prev_key='<C-p>'
let g:multi_cursor_skip_key='<C-x>'
let g:multi_cursor_quit_key='<Esc>'

" ################### åŠŸèƒ½ç›¸å…³ ###################

" æ–‡ä»¶æœç´¢
" change to https://github.com/ctrlpvim/ctrlp.vim
Bundle 'ctrlpvim/ctrlp.vim'
let g:ctrlp_map = '<leader>p'
let g:ctrlp_cmd = 'CtrlP'
map <leader>f :CtrlPMRU<CR>
let g:ctrlp_custom_ignore = {
    \ 'dir':  '\v[\/]\.(git|hg|svn|rvm|node_modules)$',
    \ 'file': '\v\.(exe|so|dll|zip|tar|tar.gz|pyc)$',
    \ }
let g:ctrlp_working_path_mode=0
let g:ctrlp_match_window_bottom=1
let g:ctrlp_max_height=15
let g:ctrlp_match_window_reversed=0
let g:ctrlp_mruf_max=500
let g:ctrlp_follow_symlinks=1
" å¦‚æœå®‰è£…äº†ag, ä½¿ç”¨ag
if executable('ag')
  " Use ag in CtrlP for listing files. Lightning fast and respects .gitignore
  let g:ctrlp_user_command = 'ag %s -l --nocolor -g ""'
  " ag is fast enough that CtrlP doesn't need to cache
  let g:ctrlp_use_caching = 0
endif


" ctrlpæ’ä»¶1 - ä¸ç”¨ctagè¿›è¡Œå‡½æ•°å¿«é€Ÿè·³è½¬
" Bundle 'tacahiroy/ctrlp-funky'
" nnoremap <Leader>fu :CtrlPFunky<Cr>
" " narrow the list down with a word under cursor
" nnoremap <Leader>fU :execute 'CtrlPFunky ' . expand('<cword>')<Cr>
" let g:ctrlp_funky_syntax_highlight = 1

" let g:ctrlp_extensions = ['funky']

" ç±»ä¼¼sublimetextçš„æœç´¢
" Bundle "dyng/ctrlsf.vim"
" In CtrlSF window:
" å›è½¦/o, æ‰“å¼€
" t       åœ¨tabä¸­æ‰“å¼€(å»ºè®®)
" T - Lkie t but focus CtrlSF window instead of opened new tab.
" q - Quit CtrlSF window.
" nmap \ <Plug>CtrlSFCwordPath<CR>
" let g:ctrlsf_position = 'below'
" let g:ctrlsf_winsize = '30%'
" let g:ctrlsf_auto_close = 0
" let g:ctrlsf_confirm_save = 0
" Note: cannot use <CR> or <C-m> for open
" Use : <sapce> or <tab>
" let g:ctrlsf_mapping = {
    " \ "open"  : "<Space>",
    " \ "openb" : "O",
    " \ "tab"   : "t",
    " \ "tabb"  : "T",
    " \ "prevw" : "p",
    " \ "quit"  : "q",
    " \ "next"  : "<C-J>",
    " \ "prev"  : "<C-K>",
    " \ "pquit" : "q",
    " \ }


" git.  gitæ“ä½œè¿˜æ˜¯ä¹ æƒ¯å‘½ä»¤è¡Œ,vimé‡Œé¢å¤„ç†ç®€å•diffç¼–è¾‘æ“ä½œ
" :Gdiff  :Gstatus :Gvsplit
Bundle 'tpope/vim-fugitive'
nnoremap <leader>ge :Gdiff<CR>
" not ready to open
" <leader>gb maps to :Gblame<CR>
" <leader>gs maps to :Gstatus<CR>
" <leader>gd maps to :Gdiff<CR>  å’Œç°æœ‰å†²çª
" <leader>gl maps to :Glog<CR>
" <leader>gc maps to :Gcommit<CR>
" <leader>gp maps to :Git push<CR>

" åŒgit diff,å®æ—¶å±•ç¤ºæ–‡ä»¶ä¸­ä¿®æ”¹çš„è¡Œ
" åªæ˜¯ä¸å–œæ¬¢é™¤äº†è¡Œå·å¤šä¸€åˆ—, é»˜è®¤å…³é—­,gsæ—¶æ‰“å¼€
Bundle 'airblade/vim-gitgutter'
let g:gitgutter_map_keys = 0
let g:gitgutter_enabled = 0
let g:gitgutter_highlight_lines = 1
nnoremap <leader>gs :GitGutterToggle<CR>

" edit history, å¯ä»¥æŸ¥çœ‹å›åˆ°æŸä¸ªå†å²çŠ¶æ€
Bundle 'sjl/gundo.vim'
noremap <leader>h :GundoToggle<CR>

" ################### æ˜¾ç¤ºå¢å¼º ###################

" çŠ¶æ€æ å¢å¼ºå±•ç¤º
" æ–°çš„airlineé…ç½®
Bundle 'bling/vim-airline'
if !exists('g:airline_symbols')
    let g:airline_symbols = {}
endif
let g:airline_left_sep = 'â–¶'
let g:airline_left_alt_sep = 'â¯'
let g:airline_right_sep = 'â—€'
let g:airline_right_alt_sep = 'â®'
let g:airline_symbols.linenr = 'Â¶'
let g:airline_symbols.branch = 'â‡'
" æ˜¯å¦æ‰“å¼€tabline
" let g:airline#extensions#tabline#enabled = 1



" æ‹¬å·æ˜¾ç¤ºå¢å¼º
Bundle 'kien/rainbow_parentheses.vim'
" ä¸åŠ å…¥è¿™è¡Œ, é˜²æ­¢é»‘è‰²æ‹¬å·å‡ºç°, å¾ˆéš¾è¯†åˆ«
" \ ['black',       'SeaGreen3'],
let g:rbpt_colorpairs = [
    \ ['brown',       'RoyalBlue3'],
    \ ['Darkblue',    'SeaGreen3'],
    \ ['darkgray',    'DarkOrchid3'],
    \ ['darkgreen',   'firebrick3'],
    \ ['darkcyan',    'RoyalBlue3'],
    \ ['darkred',     'SeaGreen3'],
    \ ['darkmagenta', 'DarkOrchid3'],
    \ ['brown',       'firebrick3'],
    \ ['gray',        'RoyalBlue3'],
    \ ['darkmagenta', 'DarkOrchid3'],
    \ ['Darkblue',    'firebrick3'],
    \ ['darkgreen',   'RoyalBlue3'],
    \ ['darkcyan',    'SeaGreen3'],
    \ ['darkred',     'DarkOrchid3'],
    \ ['red',         'firebrick3'],
    \ ]

let g:rbpt_max = 16
let g:rbpt_loadcmd_toggle = 0
au VimEnter * RainbowParenthesesToggle
au Syntax * RainbowParenthesesLoadRound
au Syntax * RainbowParenthesesLoadSquare
au Syntax * RainbowParenthesesLoadBraces


" ä¸»é¢˜ dracula
" Bundle 'zenorocha/dracula-theme', {'rtp': 'vim/'}
Bundle 'crusoexia/vim-dracula'

Bundle 'mhartington/oceanic-next'

"ç›®å½•å¯¼èˆª
Bundle 'scrooloose/nerdtree'
map <leader>n :NERDTreeToggle<CR>
let NERDTreeHighlightCursorline=1
let NERDTreeIgnore=[ '\.pyc$', '\.pyo$', '\.obj$', '\.o$', '\.so$', '\.egg$', '^\.git$', '^\.svn$', '^\.hg$' ]
"close vim if the only window left open is a NERDTree
autocmd bufenter * if (winnr("$") == 1 && exists("b:NERDTreeType") && b:NERDTreeType == "primary") | q | end
" s/v åˆ†å±æ‰“å¼€æ–‡ä»¶
let g:NERDTreeMapOpenSplit = 's'
let g:NERDTreeMapOpenVSplit = 'v'

Bundle 'jistr/vim-nerdtree-tabs'
map <Leader>n <plug>NERDTreeTabsToggle<CR>
" å…³é—­åŒæ­¥
let g:nerdtree_tabs_synchronize_view=0
let g:nerdtree_tabs_synchronize_focus=0
" è‡ªåŠ¨å¼€å¯nerdtree
let g:nerdtree_tabs_open_on_console_startup=1

" Vim Workspace Controller
Bundle "szw/vim-ctrlspace"
let g:airline_exclude_preview = 1
hi CtrlSpaceSelected guifg=#586e75 guibg=#eee8d5 guisp=#839496 gui=reverse,bold ctermfg=10 ctermbg=7 cterm=reverse,bold
hi CtrlSpaceNormal   guifg=#839496 guibg=#021B25 guisp=#839496 gui=NONE ctermfg=12 ctermbg=0 cterm=NONE
hi CtrlSpaceSearch   guifg=#cb4b16 guibg=NONE gui=bold ctermfg=9 ctermbg=NONE term=bold cterm=bold
hi CtrlSpaceStatus   guifg=#839496 guibg=#002b36 gui=reverse term=reverse cterm=reverse ctermfg=12 ctermbg=8


" For tmux navigator Ctrl-hjkl
Bundle 'christoomey/vim-tmux-navigator'

" ###### Ruby #########
" Bundle 'vim-ruby/vim-ruby'
" Bundle 'nelstrom/vim-textobj-rubyblock'

" æœ‰bug, å’Œå½“å‰æœ‰å†²çª, å°šæœªè§£å†³, ä¸è¦æ‰“å¼€
" Bundle 'tpope/vim-endwise'
" Bundle 'tpope/vim-rails'


" ###### Markdown #########
Bundle 'plasticboy/vim-markdown'
let g:vim_markdown_folding_disabled=1

" https://github.com/suan/vim-instant-markdown
" npm -g install instant-markdown-d
" Bundle 'suan/vim-instant-markdown'
" let g:instant_markdown_slow = 1
" let g:instant_markdown_autostart = 0
" map <F12> :InstantMarkdownPreview<CR>

" ###### HTML/JS/JQUERY/CSS #########

Bundle 'othree/yajs.vim'
Bundle "pangloss/vim-javascript"
let g:html_indent_inctags = "html,body,head,tbody"
let g:html_indent_script1 = "inc"
let g:html_indent_style1 = "inc"

Bundle 'mxw/vim-jsx'
let g:jsx_ext_required = 0

" ###### emmet HTML complete #########
" Bundle "mattn/emmet-vim"

" ###### Jinja2 #########
Bundle 'Glench/Vim-Jinja2-Syntax'

" for css color
" not work in iterm2 which termianl selection is not xterm-256
" Bundle 'ap/vim-css-color'
Bundle 'JulesWang/css.vim'
Bundle 'cakebaker/scss-syntax.vim'

Bundle 'mileszs/ack.vim'
